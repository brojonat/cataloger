{% extends "base.html" %} {% block title %}Catalog History - {{ prefix }}{%
endblock %} {% block content %}
<div class="breadcrumb">
  <a href="/">Home</a> /
  <span>{{ prefix }}</span>
</div>

<h2>Catalog History</h2>
<p class="subtitle">
  <strong>Prefix:</strong> {{ prefix }}<br />
  <strong>Total Snapshots:</strong> {{ catalog_runs|length }}
</p>

<div class="actions">
  <a href="/" class="button secondary">Back to Home</a>
</div>

<div class="catalog-table-container">
  <table class="catalog-table">
    <thead>
      <tr>
        <th>Timestamp</th>
        <th>Catalog</th>
        <th>Summary</th>
        <th>Scripts</th>
        <th>Comments</th>
      </tr>
    </thead>
    <tbody>
      {% for run in catalog_runs %}
      <tr>
        <td class="timestamp-cell">
          <strong>{{ run.timestamp }}</strong>
          {% if loop.first %}
          <span class="badge">Latest</span>
          {% endif %}
        </td>
        <td>
          {% for file in run.files.html %} {% if file.filename == 'catalog.html'
          %}
          <a
            href="/api/catalog/view?prefix={{ prefix }}&timestamp={{ run.timestamp }}&filename={{ file.filename }}"
            class="file-link"
            target="_blank"
          >
            üìä View Catalog
          </a>
          {% endif %} {% endfor %}
        </td>
        <td>
          {% for file in run.files.html %} {% if file.filename ==
          'recent_summary.html' %}
          <a
            href="/api/catalog/view?prefix={{ prefix }}&timestamp={{ run.timestamp }}&filename={{ file.filename }}"
            class="file-link"
            target="_blank"
          >
            üìà View Summary
          </a>
          {% endif %} {% endfor %}
        </td>
        <td>
          {% if run.files.scripts %}
          <div class="file-list">
            {% for file in run.files.scripts %}
            <a
              href="/api/catalog/view?prefix={{ prefix }}&timestamp={{ run.timestamp }}&filename={{ file.filename }}"
              class="file-link"
              target="_blank"
            >
              üêç {{ file.filename }}
            </a>
            {% endfor %}
          </div>
          {% else %}
          <span class="empty-cell">‚Äî</span>
          {% endif %}
        </td>
        <td>
          {% if run.files.comments %}
          <span class="comment-count">üí¨ {{ run.files.comments|length }}</span>
          {% else %}
          <span class="empty-cell">‚Äî</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% if not catalog_runs %}
<div class="empty-state">
  <p>No catalog runs found for this prefix.</p>
  <a href="/" class="button">Back to Home</a>
</div>
{% endif %} {% endblock %}
